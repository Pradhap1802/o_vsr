<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="paperformat_vsr_coa" model="report.paperformat">
            <field name="name">VSR COA Paper Format</field>
            <field name="default" eval="False"/>
            <field name="format">A4</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">10</field>
            <field name="margin_bottom">10</field>
            <field name="margin_left">10</field>
            <field name="margin_right">10</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">0</field>
            <field name="dpi">90</field>
        </record>

        <record id="action_report_vsr_coa" model="ir.actions.report">
            <field name="name">Certificate of Analysis</field>
            <field name="model">vsr.coa</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">vsr_packing_memo.report_vsr_coa_document</field>
            <field name="report_file">vsr_packing_memo.report_vsr_coa_document</field>
            <field name="print_report_name">'COA - %s' % object.name</field>
            <field name="binding_model_id" ref="model_vsr_coa"/>
            <field name="binding_type">report</field>
            <field name="paperformat_id" ref="paperformat_vsr_coa"/>
        </record>

        <template id="report_vsr_coa_document">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <div class="page" style="font-family: Arial, sans-serif; font-size: 11px;">
                        
                        <!-- Header with Border -->
                        <div style="border: 2px solid black; padding: 10px; margin-bottom: 0px;">
                            <!-- Header Content -->
                            <div style="text-align: center; margin-bottom: 1px;">
                                 <!-- Company Info from Environment -->
                                <h1 style="margin: 0; font-weight: bold; text-transform: uppercase;"><span t-esc="o.env.company.name"/></h1>
                                <p style="margin: 0; font-size: 14px;">
                                    <span t-esc="o.env.company.street"/> <span t-esc="o.env.company.street2"/>, <span t-esc="o.env.company.city"/>-<span t-esc="o.env.company.zip"/>, <span t-esc="o.env.company.state_id.name"/>
                                </p>
                            </div>
                            <div style="position: absolute; right: 20px; top: 10px;">
                                <img t-if="o.env.company.logo" t-att-src="'data:image/png;base64,%s' % o.env.company.logo.decode('utf-8')" style="max-height: 60px; max-width: 100px;" alt="Logo"/>
                            </div>
                        </div>

                        <!-- Title -->
                        <div style="border: 2px solid black; border-top: none; text-align: center; padding: 5px; font-weight: bold;">
                            CERTIFICATE OF ANALYSIS
                        </div>

                        <!-- Layout Table -->
                        <table style="width: 100%; border-collapse: collapse; border: 2px solid black; border-top: none;">
                            <tr>
                                <td rowspan="5" style="width: 30%; border: 1px solid black; border-bottom: none; vertical-align: top; padding: 5px;">
                                    <strong>CUSTOMER NAME &amp; ADDRESS</strong><br/><br/>
                                    <span t-if="o.partner_id" t-field="o.partner_id" t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
                                </td>
                                <!-- Details Columns -->
                                <td style="width: 20%; border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">CERTIFICATE No</td>
                                <td style="width: 25%; border: 1px solid black; padding: 5px; text-align: center;"><span t-field="o.name"/></td>
                                <td style="width: 10%; border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">Invoice No.</td>
                                <td style="width: 15%; border: 1px solid black; padding: 5px; text-align: center;"><span t-field="o.invoice_no"/></td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">
                                    <t t-if="o.category == 'brine/salted'">DATE OF PACKING</t>
                                    <t t-else="">DATE OF PROCESSING</t>
                                </td>
                                <td style="border: 1px solid black; padding: 5px; text-align: center;"><span t-field="o.date_processing"/></td>
                                <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">Truck No.</td>
                                <td style="border: 1px solid black; padding: 5px; text-align: center;"><span t-field="o.truck_no"/></td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">PO NUMBER</td>
                                <td colspan="3" style="border: 1px solid black; padding: 5px; text-align: center;"><span t-field="o.po_number"/></td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">LOT NO/BATCH NO</td>
                                <td colspan="3" style="border: 1px solid black; padding: 5px; text-align: center;"><span t-field="o.lot_no"/></td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">PRODUCT DESCRIPTION</td>
                                <td colspan="3" style="border: 1px solid black; padding: 5px; text-align: center;"><span t-field="o.product_description"/></td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid black; border-top: none; padding: 5px; text-align: center; font-weight: bold;"></td>
                                <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">DISPATCH DATE</td>
                                <td colspan="3" style="border: 1px solid black; padding: 5px; text-align: center;"><span t-field="o.dispatch_date"/></td>
                            </tr>
                        </table>

                        <!-- Analytical Parameters Header -->
                        <div style="border: 2px solid black; border-top: none; text-align: center; padding: 5px; font-weight: bold;">
                            ANALYTICAL PARAMETERS
                        </div>

                        <!-- Parameters Table -->
                        <table style="width: 100%; border-collapse: collapse; border: 2px solid black; border-top: none;">
                            <thead style="font-weight: bold;">
                                <tr>
                                    <td style="width: 25%; border: 1px solid black; padding: 5px; text-align: center;">PARAMETERS TESTED</td>
                                    <td style="width: 25%; border: 1px solid black; padding: 5px; text-align: center;">UNIT OF MEASUREMENT</td>
                                    <td style="width: 15%; border: 1px solid black; padding: 5px; text-align: center;">RESULT</td>
                                    <td style="width: 20%; border: 1px solid black; padding: 5px; text-align: center;">STANDARD (AS PER PRODUCT SPECS)</td>
                                    <td style="width: 15%; border: 1px solid black; padding: 5px; text-align: center;">TEST METHOD</td>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="o.line_ids" t-as="line">
                                    <tr>
                                        <td style="border: 1px solid black; padding: 15px; text-align: center;"><span t-field="line.parameter"/></td>
                                        <td style="border: 1px solid black; padding: 15px; text-align: center;"><span t-field="line.uom"/></td>
                                        <td style="border: 1px solid black; padding: 15px; text-align: center;"><span t-field="line.result"/></td>
                                        <td style="border: 1px solid black; padding: 15px; text-align: center;"><span t-field="line.standard"/></td>
                                        <td style="border: 1px solid black; padding: 15px; text-align: center;"><span t-field="line.test_method"/></td>
                                    </tr>
                                </t>
                                <!-- Footer within table for Brine/Salted or All? -->
                                <tr>
                                    <td style="border: 1px solid black; padding: 10px; font-weight: bold;">Exp.Date</td>
                                    <td colspan="4" style="border: 1px solid black; padding: 10px;"><span t-field="o.exp_date_text"/></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid black; padding: 10px; font-weight: bold;">Variety Of Pickle</td>
                                    <td colspan="4" style="border: 1px solid black; padding: 10px;"><span t-field="o.variety_of_pickle"/></td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="border: 1px solid black; padding: 10px;">
                                        <strong>COMMENT:</strong> <span t-field="o.comment"/>
                                        <br/><br/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Verification Footer -->
                        <table style="width: 100%; border-collapse: collapse; border: 2px solid black; border-top: none;">
                             <tr>
                                <td colspan="2" style="width: 50%; border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">VERIFIED&amp;APPROVED BY</td>
                                <td colspan="2" style="width: 50%; border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">PREPARED BY</td>
                            </tr>
                            <tr>
                                <td style="width: 15%; border-right: none; padding: 5px; font-weight: bold;">NAME:</td>
                                <td style="width: 35%; border-left: none; padding: 5px;"><span t-field="o.verified_by"/></td>
                                <td style="width: 15%; border-right: none; padding: 5px; font-weight: bold;">NAME:</td>
                                <td style="width: 35%; border-left: none; padding: 5px;"><span t-field="o.prepared_by"/></td>
                            </tr>
                             <tr>
                                <td style="border-right: none; padding: 20px 5px 5px 5px; font-weight: bold;">SIGNATURE:</td>
                                <td style="border-left: none; padding: 20px 5px 5px 5px;">______________________________</td>
                                <td style="border-right: none; padding: 20px 5px 5px 5px; font-weight: bold;">SIGNATURE:</td>
                                <td style="border-left: none; padding: 20px 5px 5px 5px;">______________________________</td>
                            </tr>
                        </table>
                        
                    </div>
                </t>
            </t>
        </template>
    </data>
</odoo>
